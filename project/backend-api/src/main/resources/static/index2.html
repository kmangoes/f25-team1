<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cafe Quest</title>
  <style>
    body {
      margin: 0;
      font-family: Cinzel Decorative serif, Cinzel, serif;
      background: #f4efe7;
      color: #3e2723;
    }

    * {
      box-sizing: border-box;
    }

    .page {
      display: none;
      height: 100vh;
    }

    /* Login */
    #auth-page {
      display: flex;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, #bc9e7d, #4d351c);
      min-height: 100vh;
    }

    .auth-box {
      background: #fff;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.25);
      width: 320px;
      text-align: center;
    }

    .auth-box h2 {
      margin-bottom: 20px;
      color: #4d351c;
    }

    .auth-box input {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 8px;
      box-sizing: border-box;
    }

    .auth-box button {
      width: 100%;
      padding: 12px;
      background-color: #6d4c41;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .auth-box button:hover {
      background-color: #4e342e;
    }

    .error-message {
      color: red;
      margin-top: 10px;
      font-size: 14px;
    }

    /* Home page */
    #home-page, #events-page {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    header {
      display: flex;
      align-items: center;
      padding: 15px;
      margin-left: 90px;
      background: #f4efe7;
    }

    header .logo-space img {
      width: 60px;
      height: 60px;
      border-radius: 10px;
      margin-right: 15px;
    }

    header h1 {
      font-size: 22px;
      margin: 0;
      flex: 1;
    }

    .content {
      flex: 1;
      overflow-y: auto;
      padding: 15px;
      margin-left: 90px;
      padding-bottom: 60px;
    }

    .shop {
      display: flex;
      flex-direction: row;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
      margin-bottom: 20px;
      overflow: hidden;
      transition: transform 0.3s ease;
    }

    .shop:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .shop img {
      width: 200px;
      height: 200px;
      background: #d7ccc8;
      object-fit: cover;
    }

    .shop-info {
      width: 40%;
      padding: 15px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .shop-name {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 10px;
      color: #3e2723;
    }

    .shop-info div {
      margin: 6px 0;
      padding: 8px;
      background: #efebe9;
      border-radius: 6px;
      text-align: center;
      font-size: 14px;
    }

    .detail-card {
      background: #fff;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    }

    .detail-card h2, .detail-card h3 {
      margin-top: 0;
      margin-bottom: 15px;
      color: #3e2723;
    }

    .rating-form {
      display: grid;
      gap: 15px;
    }

    .rating-form label {
      font-weight: bold;
      margin-bottom: 5px;
      display: block;
      color: #3e2723;
    }

    .rating-form select,
    .rating-form textarea,
    .event-form input,
    .event-form select,
    .event-form textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }

    .rating-form textarea {
      min-height: 100px;
      resize: vertical;
    }

    .submit-review-btn, .create-event-btn {
      background-color: #6d4c41;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.3s;
      width: 100%;
    }

    .submit-review-btn:hover, .create-event-btn:hover {
      background-color: #4e342e;
    }

    .reviews-list {
      margin-top: 20px;
    }

    .review-item {
      background: #efebe9;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
    }

    .review-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .reviewer-name {
      font-weight: bold;
      color: #3e2723;
    }

    .review-date {
      color: #666;
      font-size: 12px;
    }

    .review-ratings {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      margin: 10px 0;
      font-size: 13px;
    }

    .review-text {
      margin-top: 10px;
      line-height: 1.5;
      color: #3e2723;
    }

    /* Left nav */
    nav {
      position: fixed;
      left: 0;
      top: 0;
      height: 100vh;
      width: 80px;
      background-color: #a1887f;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      padding-top: 20px;
      z-index: 1000;
    }

    nav div {
      text-align: center;
      color: #fff;
      font-size: 12px;
      margin-bottom: 20px;
      cursor: pointer;
      transition: transform 0.3s;
    }

    nav div:hover {
      transform: scale(1.1);
    }

    nav img {
      width: 35px;
      height: 35px;
      object-fit: cover;
      border-radius: 6px;
      display: block;
      margin-bottom: 5px;
    }

    .user-dropdown {
      position: absolute;
      right: 20px;
      top: 20px;
      font-size: 16px;
      cursor: pointer;
      user-select: none;
    }

    .user-dropdown span {
      font-weight: bold;
      color: #3e2723;
    }

    .dropdown-menu {
      position: absolute;
      right: 0;
      top: 28px;
      background: white;
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 8px 12px;
      display: none;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      cursor: pointer;
      width: 120px;
    }

    .dropdown-menu div:hover {
      background: #eee;
      border-radius: 4px;
    }

    /* Events Page */
    .events-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .events-header h2 {
      margin: 0;
      color: #3e2723;
    }

    .add-event-btn {
      background-color: #6d4c41;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      transition: background 0.3s;
    }

    .add-event-btn:hover {
      background-color: #4e342e;
    }

    .event-card {
      background: #fff;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
      transition: transform 0.3s ease;
    }

    .event-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .event-card h3 {
      margin: 0 0 10px 0;
      color: #3e2723;
      font-size: 20px;
    }

    .event-info {
      color: #666;
      margin: 5px 0;
      font-size: 14px;
    }

    .event-type {
      display: inline-block;
      background: #efebe9;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: bold;
      margin-top: 8px;
      color: #6d4c41;
    }

    .event-form {
      display: grid;
      gap: 15px;
    }

    .event-form label {
      font-weight: bold;
      display: block;
      margin-bottom: 5px;
      color: #3e2723;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 2000;
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      background: white;
      padding: 30px;
      border-radius: 12px;
      width: 90%;
      max-width: 500px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 6px 18px rgba(0,0,0,0.3);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .modal-header h2 {
      margin: 0;
      color: #3e2723;
    }

    .close-modal {
      font-size: 28px;
      cursor: pointer;
      color: #666;
    }

    .close-modal:hover {
      color: #3e2723;
    }

    .no-events {
      text-align: center;
      color: #666;
      padding: 40px;
      font-size: 16px;
    }

    @media (max-width: 768px) {
      header, .content {
        margin-left: 0;
      }

      nav {
        width: 100%;
        height: 60px;
        flex-direction: row;
        bottom: 0;
        top: auto;
        padding: 10px 0;
      }

      nav div {
        margin-bottom: 0;
      }

      .content {
        padding-bottom: 80px;
      }
    }
  </style>
</head>
<body>

  <!-- Login Page -->
  <div id="auth-page" class="page" style="display: flex;">
    <div class="auth-box">
      <h2>Cafe Quest Login</h2>
      <input type="email" id="email" placeholder="Student Email" required>
      <input type="password" id="password" placeholder="Password" required>
      <button onclick="validateLogin()">Login</button>
    </div>
  </div>

  <!-- Home Page -->
  <div id="home-page" class="page">
    <header>
      <div class="logo-space">
        <img src="https://github.com/kmangoes/final_ver_provider_side/blob/main/src/main/resources/static/img/cafequest_logo.png?raw=true" alt="Cafe Quest Logo">
      </div>
      <h1>Cafe Quest</h1>
      <div class="user-dropdown" onclick="toggleDropdown()">
        <span id="logged-user"></span> ‚ñº
        <div id="dropdown-menu" class="dropdown-menu">
          <div onclick="logout()">Logout</div>
        </div>
      </div>
    </header>

    <div class="content">
      <!-- SHOP 1 -->
      <div class="shop">
        <img src="https://i0.wp.com/33andelmcoffeehouse.com/wp-content/uploads/2024/08/Corner-of-33-Elm_2.jpg?ssl=1" alt="33 & Elm Coffee House">
        <div class="shop-info">
          <h2 class="shop-name">33 & Elm Coffee House</h2>
          <div>üìç 123 Highland Ave.</div>
          <div>‚òï Specialty Coffee</div>
          <div>‚≠ê Great Study Spot</div>
        </div>
      </div>

      <div class="detail-card">
        <h2>Write a Review</h2>
        <form class="rating-form" onsubmit="submitReview(event, 'shop1')">
          <select id="study-rating-shop1"><option value="">Study-ability</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
          <select id="comfort-rating-shop1"><option value="">Comfort</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
          <select id="access-rating-shop1"><option value="">Accessibility</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
          <select id="coffee-rating-shop1"><option value="">Coffee Quality</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
          <textarea id="review-text-shop1" placeholder="Write your review..."></textarea>
          <button class="submit-review-btn">Submit Review</button>
        </form>
      </div>

      <div class="detail-card">
        <h3>Reviews</h3>
        <div id="reviews-container-shop1"></div>
      </div>

      <!-- SHOP 2 -->
      <div class="shop">
        <img src="https://s3-media0.fl.yelpcdn.com/bphoto/PA1pno4zoFsTHBvuShVePA/348s.jpg" alt="Tate Street Coffee House">
        <div class="shop-info">
          <h2 class="shop-name">Tate Street Coffee House</h2>
          <div>üìç 456 Spring Garden St.</div>
          <div>‚òï Artisan Brews</div>
          <div>‚≠ê Cozy Atmosphere</div>
        </div>
      </div>

      <div class="detail-card">
        <h2>Write a Review</h2>
        <form class="rating-form" onsubmit="submitReview(event, 'shop2')">
          <select id="study-rating-shop2"><option value="">Study-ability</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
          <select id="comfort-rating-shop2"><option value="">Comfort</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
          <select id="access-rating-shop2"><option value="">Accessibility</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
          <select id="coffee-rating-shop2"><option value="">Coffee Quality</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
          <textarea id="review-text-shop2" placeholder="Write your review..."></textarea>
          <button class="submit-review-btn">Submit Review</button>
        </form>
      </div>

      <div class="detail-card">
        <h3>Reviews</h3>
        <div id="reviews-container-shop2"></div>
      </div>
    </div>
  </div>

  <!-- Events Page -->
  <div id="events-page" class="page">
    <header>
      <div class="logo-space">
        <img src="https://github.com/kmangoes/final_ver_provider_side/blob/main/src/main/resources/static/img/cafequest_logo.png?raw=true" alt="Cafe Quest Logo">
      </div>
      <h1>My Events</h1>
      <div class="user-dropdown" onclick="toggleDropdown()">
        <span id="logged-user-events"></span> ‚ñº
        <div id="dropdown-menu-events" class="dropdown-menu">
          <div onclick="logout()">Logout</div>
        </div>
      </div>
    </header>

    <div class="content">
      <div class="events-header">
        <h2>Upcoming Events</h2>
        <button class="add-event-btn" onclick="openEventModal()">+ Create Event</button>
      </div>

      <div id="events-container"></div>
    </div>
  </div>

  <!-- Create Event Modal -->
  <div id="event-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Create New Event</h2>
        <span class="close-modal" onclick="closeEventModal()">&times;</span>
      </div>
      <form class="event-form" onsubmit="createEvent(event)">
        <div>
          <label>Event Name</label>
          <input type="text" id="event-name" required placeholder="e.g., CSC-330 Study Group">
        </div>
        <div>
          <label>Location</label>
          <select id="event-location" required>
            <option value="">Select a coffee shop</option>
            <option value="33 & Elm Coffee House">33 & Elm Coffee House</option>
            <option value="Tate Street Coffee House">Tate Street Coffee House</option>
          </select>
        </div>
        <div>
          <label>Event Type</label>
          <select id="event-type" required>
            <option value="">Select type</option>
            <option value="Study Group">Study Group</option>
            <option value="Social">Social</option>
            <option value="Competition">Competition</option>
            <option value="Performance">Performance</option>
            <option value="Other">Other</option>
          </select>
        </div>
        <div>
          <label>Date</label>
          <input type="date" id="event-date" required>
        </div>
        <div>
          <label>Time</label>
          <input type="time" id="event-time" required>
        </div>
        <div>
          <label>Description (Optional)</label>
          <textarea id="event-description" rows="3" placeholder="Add any additional details..."></textarea>
        </div>
        <button type="submit" class="create-event-btn">Create Event</button>
      </form>
    </div>
  </div>

  <!-- Left Nav -->
  <nav>
    <div onclick="showPage('home')">
      <img src="https://i.pinimg.com/1200x/c3/41/6e/c3416efade9f62b399498e657113ddf7.jpg" alt="Home">
      Home
    </div>
    <div onclick="showPage('events')">
      <img src="https://i.pinimg.com/736x/bb/86/e7/bb86e710bc7167e62f7982e4d04de5e2.jpg" alt="My Events">
      My Events
    </div>
    <div>
      <img src="https://i.pinimg.com/736x/71/4a/cf/714acfb1b90df376dfa9906c1e316c67.jpg" alt="Me">
      Me
    </div>
  </nav>

  <script>
    let loggedInUser = { name: "", email: "" };

    function validateLogin() {
      const email = document.getElementById("email").value;

      if (!email.endsWith("@uncg.edu")) {
        alert("Use a UNCG email.");
        return;
      }

      loggedInUser.email = email;
      loggedInUser.name = email.split("@")[0];

      document.getElementById("logged-user").textContent = "Logged in as " + loggedInUser.name;
      document.getElementById("logged-user-events").textContent = "Logged in as " + loggedInUser.name;

      document.getElementById("auth-page").style.display = "none";
      document.getElementById("home-page").style.display = "flex";
    }

    function toggleDropdown() {
      const menu = document.getElementById("dropdown-menu");
      const menuEvents = document.getElementById("dropdown-menu-events");
      if (menu) menu.style.display = menu.style.display === "block" ? "none" : "block";
      if (menuEvents) menuEvents.style.display = menuEvents.style.display === "block" ? "none" : "block";
    }

    function logout() {
      document.getElementById("dropdown-menu").style.display = "none";
      document.getElementById("dropdown-menu-events").style.display = "none";
      document.getElementById("home-page").style.display = "none";
      document.getElementById("events-page").style.display = "none";
      document.getElementById("auth-page").style.display = "flex";
      loggedInUser = { name: "", email: "" };
      document.getElementById("logged-user").textContent = "";
      document.getElementById("logged-user-events").textContent = "";
    }

    function showPage(page) {
      document.getElementById("home-page").style.display = "none";
      document.getElementById("events-page").style.display = "none";
      
      if (page === 'home') {
        document.getElementById("home-page").style.display = "flex";
      } else if (page === 'events') {
        document.getElementById("events-page").style.display = "flex";
        renderEvents();
      }
    }

    function submitReview(event, shopId) {
      event.preventDefault();

      const study = document.getElementById(`study-rating-${shopId}`).value;
      const comfort = document.getElementById(`comfort-rating-${shopId}`).value;
      const access = document.getElementById(`access-rating-${shopId}`).value;
      const coffee = document.getElementById(`coffee-rating-${shopId}`).value;
      const text = document.getElementById(`review-text-${shopId}`).value;

      if (!study || !comfort || !access || !coffee) {
        alert("Please select all ratings");
        return;
      }

      const reviewObj = {
        user: loggedInUser.name,
        email: loggedInUser.email,
        study,
        comfort,
        access,
        coffee,
        text,
        date: new Date().toLocaleDateString()
      };

      let allReviews = JSON.parse(localStorage.getItem(shopId)) || [];
      allReviews.push(reviewObj);
      localStorage.setItem(shopId, JSON.stringify(allReviews));

      renderReviews(shopId);
      event.target.reset();
      alert("Review submitted successfully!");
    }

    function renderReviews(shopId) {
      const container = document.getElementById(`reviews-container-${shopId}`);
      const allReviews = JSON.parse(localStorage.getItem(shopId)) || [];

      if (allReviews.length === 0) {
        container.innerHTML = '<div class="no-events">No reviews yet. Be the first to review!</div>';
        return;
      }

      container.innerHTML = "";

      allReviews.forEach(r => {
        container.innerHTML += `
          <div class="review-item">
            <div class="review-header">
              <span class="reviewer-name">${r.user}</span>
              <span class="review-date">${r.date}</span>
            </div>
            <div class="review-ratings">
              <span><strong>Study:</strong> ${r.study}/5</span>
              <span><strong>Comfort:</strong> ${r.comfort}/5</span>
              <span><strong>Access:</strong> ${r.access}/5</span>
              <span><strong>Coffee:</strong> ${r.coffee}/5</span>
            </div>
            ${r.text ? `<div class="review-text">${r.text}</div>` : ''}
          </div>
        `;
      });
    }

    function openEventModal() {
      document.getElementById("event-modal").style.display = "flex";
      const today = new Date().toISOString().split('T')[0];
      document.getElementById("event-date").setAttribute('min', today);
    }

    function closeEventModal() {
      document.getElementById("event-modal").style.display = "none";
      document.querySelector('.event-form').reset();
    }

    function createEvent(event) {
      event.preventDefault();

      const eventData = {
        name: document.getElementById("event-name").value,
        location: document.getElementById("event-location").value,
        type: document.getElementById("event-type").value,
        date: document.getElementById("event-date").value,
        time: document.getElementById("event-time").value,
        description: document.getElementById("event-description").value,
        organizer: loggedInUser.name,
        createdAt: new Date().toISOString()
      };

      let allEvents = JSON.parse(localStorage.getItem("events")) || [];
      allEvents.push(eventData);
      localStorage.setItem("events", JSON.stringify(allEvents));

      closeEventModal();
      renderEvents();
      alert("Event created successfully!");
    }

    function renderEvents() {
      const container = document.getElementById("events-container");
      const allEvents = JSON.parse(localStorage.getItem("events")) || [];

      if (allEvents.length === 0) {
        container.innerHTML = '<div class="no-events">No events yet. Create your first event!</div>';
        return;
      }

      const sortedEvents = allEvents.sort((a, b) => new Date(a.date + ' ' + a.time) - new Date(b.date + ' ' + b.time));

      container.innerHTML = "";

      sortedEvents.forEach(evt => {
        const eventDate = new Date(evt.date + ' ' + evt.time);
        const formattedDate = eventDate.toLocaleDateString('en-US', { 
          month: 'short', 
          day: 'numeric', 
          year: 'numeric' 
        });
        const formattedTime = eventDate.toLocaleTimeString('en-US', { 
          hour: 'numeric', 
          minute: '2-digit' 
        });

        container.innerHTML += `
          <div class="event-card">
            <h3>${evt.name}</h3>
            <div class="event-info">üìç ${evt.location}</div>
            <div class="event-info">üóìÔ∏è ${formattedDate} at ${formattedTime}</div>
            <div class="event-info">üë§ Organized by ${evt.organizer}</div>
            ${evt.description ? `<div class="event-info" style="margin-top: 10px;">${evt.description}</div>` : ''}
            <span class="event-type">${evt.type}</span>
          </div>
        `;
      });
    }

    window.onload = () => {
      renderReviews("shop1");
      renderReviews("shop2");
      renderEvents();
    };

    window.onclick = function(event) {
      if (event.target.id === 'event-modal') {
        closeEventModal();
      }
    };
  </script>

</body>
</html>